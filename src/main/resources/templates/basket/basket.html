<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>영양 성분 정보</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="/common/css/basket.css" rel="stylesheet">
</head>
<body>
<div class="container" th:fragment="basket">
    <div class="favorites p-2">
        <!--         즐겨찾기 목록 (for문으로 반목문 처리해서 뿌려주면 될듯)-->
        <section >
            <span class="star">⭐</span>
            <select th:each="favorite: ${bookmark}">
<!--                th:each="favorite: ${bookmark}"-->
                <option value="#">즐겨찾기 목록</option>
                <option th:value="${favorite.getFoodId()}">새우</option>
<!--                th:value="${favorite.getFoodId()}"-->
<!--                <option value="브로콜리">브로콜리</option>-->
<!--                <option value="복숭아">복숭아</option>-->
            </select>
        </section>
    </div>
    <ul class="nav nav-tabs section-tabs" id="myTab" role="tablist">
        <li class="nav-item">
            <a class="nav-link active" id="daily-tab" data-toggle="tab" href="#daily" role="tab" aria-controls="daily" aria-selected="true">일일 권장 섭취량</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" id="bmr-tab" data-toggle="tab" href="#bmr" role="tab" aria-controls="bmr" aria-selected="false">기초대사량</a>
        </li>
    </ul>
    <div class="tab-content p-1" id="myTabContent">
        <div class="tab-pane fade show active" id="daily" role="tabpanel" aria-labelledby="daily-tab">
            <div class="nutrition-info">
                <h2>영양정보</h2>
<!--                <span th:text="${session.food.name}"></span>-->
                <!--                <span th:text="${session.food84.nutrientlist}"></span>-->
                <table>
                    <thead>
                    <tr th:if="${session.food.nutrientlist.equals('에너지') != null}">
                        <th>총 내용량</th>
                        <th><input class="kcal" th:value="${session.food.nutrientlist.?[name.equals('에너지')][0].amount}" readonly>kcal</th>
                    </tr>
                    <tr th:if="${session.food.nutrientlist.equals('에너지') == null}">
                        <th>총 내용량</th>
                        <th><input class="kcal" value="0" readonly>kcal</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:if="${session.food.nutrientlist.equals('나트륨') != null}">
                        <td>나트륨 <input class="amount" th:value="${session.food.nutrientlist.?[name.equals('나트륨')][0].amount}">mg</td>
                        <td><input class="percent" value="100" readonly>%</td>
                    </tr>
                    <tr th:if="${session.food.nutrientlist.equals('나트륨') == null}">
                        <td>나트륨 <input class="amount" value="0">g</td>
                        <td><input class="percent" value="100" readonly>%</td>
                    </tr>
                    <tr th:if="${session.food.nutrientlist.equals('탄수화물') != null}">
                        <td>탄수화물 <input class="amount" th:value="${session.food.nutrientlist.?[name.equals('탄수화물')][0].amount}">g</td>
                        <td><input class="percent" value="100" readonly>%</td>
                    </tr>
                    <tr th:if="${session.food.nutrientlist.equals('탄수화물') == null}">
                        <td>탄수화물 <input class="amount" value="0">g</td>
                        <td><input class="percent" value="100" readonly>%</td>
                    </tr>
                    <tr th:if="${session.food.nutrientlist.equals('당류') != null}">
                        <td>당류<input class="amount" th:value="${session.food.nutrientlist.?[name.equals('당류')][0].amount}">g</td>
                        <td><input class="percent" value="100" readonly>%</td>
                    </tr>
                    <tr th:if="${session.food.nutrientlist.equals('당류') == null}">
                        <td>당류 <input class="amount" value="0">g</td>
                        <td><input class="percent" value="100" readonly>%</td>
                    </tr>
                    <tr th:if="${session.food.nutrientlist.equals('지방') != null}">
                        <td>지방 <input class="amount" th:value="${session.food.nutrientlist.?[name.equals('지방')][0].amount}">g</td>
                        <td><input class="percent" value="100" readonly>%</td>
                    </tr>
                    <tr th:if="${session.food.nutrientlist.equals('지방') == null}">
                        <td>지방 <input class="amount" value="0">g</td>
                        <td><input class="percent" value="100" readonly>%</td>
                    </tr>
                    <tr th:if="${session.food.nutrientlist.equals('트랜스지방산') != null}">
                        <td>트랜스지방 <input class="amount" th:value="${session.food.nutrientlist.?[name.equals('트랜스지방산')][0].amount}">g</td>
                        <td></td>
                    </tr>
                    <tr th:if="${session.food.nutrientlist.equals('트랜스지방산') == null}">
                        <td>트랜스지방 <input class="amount" value="0">g</td>
                    </tr>
                    <tr th:if="${session.food.nutrientlist.equals('포화지방산') != null}">
                        <td>포화지방 <input class="amount" th:value="${session.food.nutrientlist.?[name.equals('포화지방산')][0].amount}">g</td>
                        <td><input class="percent" value="100" readonly>%</td>
                    </tr>
                    <tr th:if="${session.food.nutrientlist.equals('포화지방산') == null}">
                        <td>포화지방 <input class="amount" value="0">g</td>
                        <td><input class="percent" value="100" readonly>%</td>
                    </tr>
                    <tr th:if="${session.food.nutrientlist.equals('콜레스테롤') != null}">
                        <td>콜레스테롤 <input class="amount" th:value="${session.food.nutrientlist.?[name.equals('콜레스테롤')][0].amount}">mg</td>
                        <td><input class="percent" value="100" readonly>%</td>
                    </tr>
                    <tr th:if="${session.food.nutrientlist.equals('콜레스테롤') == null}">
                        <td>콜레스테롤 <input class="amount" value="0">g</td>
                        <td><input class="percent" value="100" readonly>%</td>
                    </tr>
                    <tr th:if="${session.food.nutrientlist.equals('단백질') != null}">
                        <td>단백질 <input class="amount" th:value="${session.food.nutrientlist.?[name.equals('단백질')][0].amount}">g</td>
                        <td><input class="percent" value="100" readonly>%</td>
                    </tr>
                    <tr th:if="${session.food.nutrientlist.equals('단백질') == null}">
                        <td>단백질 <input class="amount" value="0">g</td>
                        <td><input class="percent" value="100" readonly>%</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="tab-pane fade" id="bmr" role="tabpanel" aria-labelledby="bmr-tab">
            <!-- 기초대사량 내용 -->
            <div class="basel">
                <h2>영양정보</h2>
                <table >
                    <!--                    th:each="nutrient : ${session.food.nutrientlist}"-->
                    <thead >
                    <tr th:if="${session.food.nutrientlist.equals('에너지') != null}">
                        <th>총 내용량</th>
                        <th><input id="amount" class="amount" th:value="${session.food.nutrientlist.?[name.equals('에너지')][0].amount}">kcal</th>
                    </tr>
                    <tr th:if="${session.food.nutrientlist.equals('에너지') == null}">
                        <th>총 내용량</th>
                        <th><input id="amount" class="amount"  value="0">kcal</th>
                    </tr>
                    <tr>
                        <td><input id="basel" type="hidden" th:value="${session.user.getBaselMetabolism()}"></td>
                        <td><input id="percent" class="percent" readonly>%</td>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
    <div class="footer p-2">
        1일 영양성분 기준치에 대한 비율(%)은 2,000kcal 기준이므로 개인의 필요열량에 따라 다를 수 있습니다.
    </div>

    <!--   담긴 식품     -->
    <div class="food">
        <table>
            <tbody>
<!--            th:if="${iterStat.index == 0 || iterStat.index == 2 || iterStat.index == 3 || iterStat.index ==  5 || iterStat.index == 6 || iterStat.index == 12 || iterStat.index == 21 || iterStat.index == 22 || iterStat.index == 23}"-->
                    <tr th:each="food : ${session.food}">
    <!--                    <td>1. 새우: 열량: 45kcal, 콜레스테롤: 45mg ... fasdfsdafasdfsd</td>-->
<!--                        <td th:text="${nutrient.name} + ': ' + ${nutrient.amount} + ${nutrient.value} + ' '"></td>-->
                        <td th:text="${food.nutrientlist[0].name} + ': ' + ${food.nutrientlist[0].amount} + ${food.nutrientlist[0].value} + ' ' + ${food.nutrientlist[2].name} + ': ' + ${food.nutrientlist[2].amount} + ${food.nutrientlist[2].value} + ' ' + ${food.nutrientlist[3].name} + ': ' + ${food.nutrientlist[3].amount} + ${food.nutrientlist[3].value} + ' ' + ${food.nutrientlist[5].name} + ': ' + ${food.nutrientlist[5].amount} + ${food.nutrientlist[5].value} + ' ' + ${food.nutrientlist[6].name} + ': ' + ${food.nutrientlist[6].amount} + ${food.nutrientlist[6].value} + ' ' + ${food.nutrientlist[12].name} + ': ' + ${food.nutrientlist[12].amount} + ${food.nutrientlist[12].value} + ' ' + ${food.nutrientlist[21].name} + ': ' + ${food.nutrientlist[21].amount} + ${food.nutrientlist[21].value} + ' ' + ${food.nutrientlist[22].name} + ': ' + ${food.nutrientlist[22].amount} + ${food.nutrientlist[22].value} + ' ' + ${food.nutrientlist[23].name} + ': ' + ${food.nutrientlist[23].amount} + ${food.nutrientlist[23].value} + ' '"></td>
                        <td><button>삭제</button></td>
<!--                        <td th:if="${iterStat.index == 0 || iterStat.index == 2 || iterStat.index == 3 || iterStat.index ==  5 || iterStat.index == 6 || iterStat.index == 12 || iterStat.index == 21 || iterStat.index == 22 || iterStat.index == 23}"><button>삭제</button></td>-->

                    </tr>
            </tbody>
        </table>
    </div>

    <div class="submit">
        <button type="submit">등록</button>
    </div>
</div>
<script>
    // JavaScript 부분은 이곳에 작성합니다.
    document.addEventListener("DOMContentLoaded", function() {
        let amount = document.getElementById("amount").value;
        let basel = document.getElementById("basel").value;

        if(basel == null || basel === 0) {
            basel = 2000;
        } else {
            basel = document.getElementById("basel").value;
        }

        let percent = Math.floor(amount / basel * 100);

        document.getElementById("percent").value = percent;
    });
</script>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
